<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cuestionario: Tema 08 - Técnicas de IA</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Arvo:wght@700&family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #1e293b; 
            --card-bg: #f8fafc;
            --primary: #f7b212;
            --text-main: #1e293b;
            --text-light: #64748b;
            --accent: #3b82f6;
            --success: #15803d;
            --error: #b91c1c;
            --feedback-bg: #f1f5f9;
        }

        body {
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            font-family: 'Inter', sans-serif;
            color: var(--text-main);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .quiz-container {
            width: 90%;
            max-width: 700px;
            background: var(--card-bg);
            border-radius: 20px;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            padding: 40px;
            position: relative;
        }

        .progress-bar-container {
            width: 100%;
            height: 8px;
            background: #e2e8f0;
            position: absolute;
            top: 0;
            left: 0;
        }

        #progress-fill {
            height: 100%;
            background: var(--primary);
            width: 0%;
            transition: width 0.3s ease;
        }

        header {
            text-align: center;
            margin-bottom: 25px;
        }

        h1 {
            font-family: 'Arvo', serif;
            font-size: 1.6rem;
            margin: 0;
            color: var(--bg-color);
        }

        .question-number {
            font-weight: 600;
            color: var(--accent);
            text-transform: uppercase;
            font-size: 0.85rem;
            letter-spacing: 1px;
            margin-bottom: 8px;
            display: block;
        }

        .question-text {
            font-size: 1.2rem;
            line-height: 1.5;
            margin-bottom: 20px;
            font-weight: 600;
        }

        .multi-hint {
            font-size: 0.8rem;
            color: var(--text-light);
            font-style: italic;
            display: block;
            margin-top: -15px;
            margin-bottom: 15px;
        }

        .options-list {
            list-style: none;
            padding: 0;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .option-item {
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            padding: 12px 18px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            font-size: 0.95rem;
        }

        .option-item:hover:not(.disabled) {
            border-color: var(--accent);
            background-color: #eff6ff;
        }

        .option-item.selected {
            border-color: var(--primary);
            background-color: #fefce8;
        }

        .option-item.correct-ans {
            border-color: var(--success);
            background-color: #f0fdf4;
            color: var(--success);
            font-weight: 600;
        }

        .option-item.wrong-ans {
            border-color: var(--error);
            background-color: #fef2f2;
            color: var(--error);
        }

        .option-item.disabled {
            cursor: default;
            opacity: 0.8;
        }

        input { margin-right: 12px; }

        .feedback-area {
            margin-top: 20px;
            padding: 15px;
            border-radius: 10px;
            background: var(--feedback-bg);
            border-left: 4px solid var(--accent);
            display: none;
        }

        .feedback-title {
            font-weight: 700;
            display: block;
            margin-bottom: 5px;
        }

        .justification {
            font-size: 0.9rem;
            line-height: 1.4;
            color: var(--text-light);
        }

        .nav-buttons {
            margin-top: 25px;
            display: flex;
            justify-content: space-between;
            gap: 10px;
        }

        button {
            padding: 10px 20px;
            border-radius: 8px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            font-size: 0.9rem;
        }

        .btn-validate { background: var(--primary); color: #000; flex-grow: 1; }
        .btn-next { background: var(--bg-color); color: white; }
        .btn-prev { background: #e2e8f0; color: var(--text-light); }
        button:disabled { opacity: 0.3; cursor: not-allowed; }

        #result-screen { text-align: center; display: none; }
        .score-circle {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            border: 6px solid var(--primary);
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.8rem;
            font-weight: 700;
            margin: 20px auto;
        }
    </style>
</head>
<body>

<div class="quiz-container">
    <div class="progress-bar-container"><div id="progress-fill"></div></div>
    
    <div id="quiz-screen">
        <header>
            <span class="question-number" id="q-count"></span>
            <h1>Tema 8: Sistemas de Recomendación</h1>
        </header>

        <div id="q-text" class="question-text"></div>
        <span id="q-hint" class="multi-hint"></span>
        <div class="options-list" id="options-container"></div>

        <div class="feedback-area" id="feedback-area">
            <span class="feedback-title" id="feedback-status"></span>
            <p class="justification" id="justification-text"></p>
        </div>

        <div class="nav-buttons">
            <button class="btn-prev" id="btn-prev" onclick="changeQuestion(-1)">Anterior</button>
            <button class="btn-validate" id="btn-validate" onclick="validateCurrent()">Validar Respuesta</button>
            <button class="btn-next" id="btn-next" onclick="changeQuestion(1)" disabled>Siguiente</button>
        </div>
    </div>

    <div id="result-screen">
        <h1>¡Test Completado!</h1>
        <div class="score-circle" id="final-score"></div>
        <p>Has finalizado el repaso sobre técnicas de recomendación.</p>
        <div style="text-align: left; background: #f1f5f9; padding: 20px; border-radius: 12px; margin-top: 20px;">
            <h3>Sugerencias de Repaso:</h3>
            <ul id="suggested-topics"></ul>
        </div>
        
        <button class="btn-next" style="margin-top: 20px; width: 100%;" onclick="location.reload()">Reiniciar Test</button>
        <button class="btn-prev" style="margin-top: 10px; width: 100%; border: 2px solid #e2e8f0;" onclick="window.location.href='index.html'">Ir al Menú Principal</button>
    </div>
</div>

<script>
    const quizData = [
        {
            question: "1. Los sistemas que utilizan valoraciones de los usuarios para recomendar contenidos emplean técnicas de:",
            options: ["A. Filtrado demográfico.", "B. Filtrado colaborativo.", "C. Filtrado basado en contenidos.", "D. Filtrado basado en usuarios."],
            correct: [1],
            type: "single",
            topic: "8.2. Introducción",
            justification: "La recomendación colaborativa se basa específicamente en las valoraciones explícitas o en historiales (información implícita) de los usuarios."
        },
        {
            question: "2. Los sistemas que utilizan información descriptiva de los contenidos para recomendar contenidos emplean técnicas de:",
            options: ["A. Filtrado demográfico.", "B. Filtrado colaborativo.", "C. Filtrado basado en contenidos.", "D. Filtrado basado en usuarios."],
            correct: [2],
            type: "single",
            topic: "8.2. Introducción",
            justification: "El filtrado basado en contenido utiliza la metainformación o metadatos descriptivos de los propios ítems para aprender la relación con el usuario."
        },
        {
            question: "3. Indica cuáles de las siguientes afirmaciones son correctas:",
            options: [
                "A. Se pueden utilizar árboles de decisión o reglas inducidas para representar el perfil del usuario.",
                "B. Algunos sistemas recomendadores utilizan técnicas de clústering para generar grupos de usuarios con perfil similar.",
                "C. Las técnicas de clústering no son utilizadas por los sistemas recomendadores.",
                "D. Los sistemas de recomendación nunca solicitan información al usuario de manera explícita."
            ],
            correct: [0, 1],
            type: "multiple",
            topic: "8.2. Representación del perfil",
            justification: "Para representar el perfil se pueden usar árboles, reglas o redes. Además, el clústering es útil para agrupar perfiles similares."
        },
        {
            question: "4. Indica cuáles de las siguientes afirmaciones son correctas:",
            options: [
                "A. Los sistemas de filtrado colaborativo basado en ítems calculan la similitud entre ítems.",
                "B. Los sistemas de filtrado colaborativo basado en ítems calculan la similitud entre usuarios.",
                "C. Los sistemas de filtrado basado en contenidos calculan la similitud entre ítems.",
                "D. Los sistemas de filtrado colaborativo basado en usuarios calculan la similitud entre ítems."
            ],
            correct: [0, 2],
            type: "multiple",
            topic: "8.3 y 8.4. Tipos de Filtrado",
            justification: "El filtrado colaborativo basado en ítems busca similitudes entre productos basados en compras/votos. El basado en contenido también compara ítems, pero analizando sus características."
        },
        {
            question: "5. Slope One es un algoritmo empleado en los sistemas de:",
            options: ["A. Filtrado demográfico.", "B. Filtrado colaborativo basado en usuarios.", "C. Filtrado basado en contenidos.", "D. Filtrado colaborativo basado en ítems."],
            correct: [1],
            type: "single",
            topic: "8.3. Algoritmo Slope One",
            justification: "Slope One es uno de los algoritmos de predicción más empleados y eficientes en sistemas de filtrado colaborativo basado en usuario."
        },
        {
            question: "6. La función de predicción de la valoración de un ítem en el algoritmo Slope One se basa en:",
            options: [
                "A. La media de valoraciones dadas al ítem por los usuarios.",
                "B. La media de la diferencia de valoraciones entre ítems.",
                "C. La mediana de valoraciones dadas al ítem por los usuarios.",
                "D. El valor máximo de la diferencia de valoraciones entre ítems."
            ],
            correct: [1],
            type: "single",
            topic: "8.3. Funcionamiento de Slope One",
            justification: "Este algoritmo predice valoraciones basándose en la diferencia media de puntuaciones que existen entre distintos ítems para otros usuarios."
        },
        {
            question: "7. Marca las frases que son correctas respecto al algoritmo de filtrado colaborativo ítem a ítem:",
            options: [
                "A. Se basa en encontrar ítems similares.",
                "B. Se basa en encontrar usuarios similares.",
                "C. Se basa en metadatos de los ítems.",
                "D. Se basa en datos binarios como las adquisiciones o no adquisiciones de los ítems."
            ],
            correct: [0, 3],
            type: "multiple",
            topic: "8.3. Filtrado ítem-a-ítem",
            justification: "Se centra en la similitud entre ítems y puede trabajar con información binaria (comprado o no comprado) en lugar de valoraciones numéricas."
        },
        {
            question: "8. ¿Qué sistemas presentan problemas para recomendar ítems recientemente incorporados al sistema?",
            options: [
                "A. Filtrado colaborativo basado en usuarios.",
                "B. Filtrado basado en contenidos.",
                "C. Filtrado colaborativo basado en ítems.",
                "D. Ninguno de los anteriores."
            ],
            correct: [0, 2],
            type: "multiple",
            topic: "8.3. Problema del ítem nuevo",
            justification: "Los sistemas colaborativos (tanto de usuario como de ítem) sufren cuando un ítem es nuevo porque no hay valoraciones previas para calcular similitudes."
        },
        {
            question: "9. Indica cuáles de las siguientes afirmaciones son correctas respecto al modelo TF-IDF.",
            options: [
                "A. Es un modelo utilizado en los sistemas recomendadores basados en contenidos.",
                "B. Utiliza la similitud del coseno para medir la similitud entre documentos.",
                "C. Utiliza la función TF-IDF para calcular la similitud entre documentos.",
                "D. Favorece a los documentos largos frente a los cortos."
            ],
            correct: [0, 1],
            type: "multiple",
            topic: "8.4. Modelo TF-IDF",
            justification: "TF-IDF se usa en recomendación basada en contenido para ponderar términos. La similitud se mide habitualmente con el coseno. El modelo se normaliza para no favorecer documentos largos."
        },
        {
            question: "10. Algunos problemas que los recomendadores basados en contenido presentan son:",
            options: [
                "A. Al usuario no siempre le interesan los ítems similares.",
                "B. Cuando un ítem no está valorado no es recomendado.",
                "C. No tienen en cuenta información subjetiva.",
                "D. No puede ofrecer información a usuarios atípicos, que no son similares a otros usuarios."
            ],
            correct: [0, 2],
            type: "multiple",
            topic: "8.4. Limitaciones del contenido",
            justification: "Tienden a recomendar siempre lo mismo (sobre-especialización) y no captan información subjetiva (como si un curso es fácil o difícil de seguir)."
        }
    ];

    let currentIdx = 0;
    const userAnswers = new Array(quizData.length).fill(null).map(() => []);
    const validatedArr = new Array(quizData.length).fill(false);

    function render() {
        const q = quizData[currentIdx];
        const isValidated = validatedArr[currentIdx];
        document.getElementById('q-count').innerText = `Pregunta ${currentIdx + 1} de ${quizData.length}`;
        document.getElementById('q-text').innerText = q.question;
        document.getElementById('q-hint').innerText = q.type === "multiple" ? "(Selecciona todas las opciones correctas)" : "";
        document.getElementById('progress-fill').style.width = `${((currentIdx + 1) / quizData.length) * 100}%`;
        const container = document.getElementById('options-container');
        container.innerHTML = "";
        q.options.forEach((opt, i) => {
            const div = document.createElement('div');
            const isSelected = userAnswers[currentIdx].includes(i);
            let statusClass = "";
            if (isValidated) {
                if (q.correct.includes(i)) statusClass = "correct-ans";
                else if (isSelected) statusClass = "wrong-ans";
                div.classList.add("disabled");
            } else if (isSelected) {
                statusClass = "selected";
            }
            div.className = `option-item ${statusClass}`;
            div.innerHTML = `<input type="${q.type === 'multiple' ? 'checkbox' : 'radio'}" ${isSelected ? 'checked' : ''} ${isValidated ? 'disabled' : ''}> <span>${opt}</span>`;
            if (!isValidated) div.onclick = () => selectOption(i);
            container.appendChild(div);
        });
        document.getElementById('feedback-area').style.display = isValidated ? "block" : "none";
        if (isValidated) {
            const isCorrect = checkCorrectness(currentIdx);
            document.getElementById('feedback-status').innerText = isCorrect ? "✓ ¡Correcto!" : "✗ Revisión Necesaria";
            document.getElementById('feedback-status').style.color = isCorrect ? "var(--success)" : "var(--error)";
            document.getElementById('justification-text').innerText = q.justification;
        }
        document.getElementById('btn-prev').disabled = currentIdx === 0;
        document.getElementById('btn-validate').style.display = isValidated ? "none" : "block";
        document.getElementById('btn-next').disabled = !isValidated;
        document.getElementById('btn-next').innerText = currentIdx === quizData.length - 1 ? "Finalizar" : "Siguiente";
    }

    function selectOption(idx) {
        if (quizData[currentIdx].type === "single") userAnswers[currentIdx] = [idx];
        else {
            const pos = userAnswers[currentIdx].indexOf(idx);
            if (pos > -1) userAnswers[currentIdx].splice(pos, 1);
            else userAnswers[currentIdx].push(idx);
        }
        render();
    }

    function validateCurrent() {
        if (userAnswers[currentIdx].length === 0) return alert("Selecciona al menos una respuesta.");
        validatedArr[currentIdx] = true;
        render();
    }

    function checkCorrectness(idx) {
        const user = userAnswers[idx].sort().join(',');
        const correct = quizData[idx].correct.sort().join(',');
        return user === correct;
    }

    function changeQuestion(step) {
        if (step === 1 && currentIdx === quizData.length - 1) return showResults();
        currentIdx += step;
        render();
    }

    function showResults() {
        document.getElementById('quiz-screen').style.display = 'none';
        document.getElementById('result-screen').style.display = 'block';
        let score = 0;
        const failedTopics = new Set();
        quizData.forEach((q, i) => { if (checkCorrectness(i)) score++; else failedTopics.add(q.topic); });
        document.getElementById('final-score').innerText = `${score}/10`;
        const list = document.getElementById('suggested-topics');
        list.innerHTML = "";
        failedTopics.forEach(t => { const li = document.createElement('li'); li.innerText = t; list.appendChild(li); });
        if (failedTopics.size === 0) list.innerHTML = "<li>¡Excelente! Eres un experto en Sistemas de Recomendación.</li>";
    }
    render();
</script>
</body>
</html>