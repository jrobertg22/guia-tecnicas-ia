<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cuestionario: Tema 03 - Técnicas de IA</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Arvo:wght@700&family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #1e293b; /* Azul pizarra suave */
            --card-bg: #f8fafc;
            --primary: #f7b212;
            --text-main: #1e293b;
            --text-light: #64748b;
            --accent: #3b82f6;
            --success: #15803d;
            --error: #b91c1c;
            --feedback-bg: #f1f5f9;
        }

        body {
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            font-family: 'Inter', sans-serif;
            color: var(--text-main);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .quiz-container {
            width: 90%;
            max-width: 700px;
            background: var(--card-bg);
            border-radius: 20px;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            padding: 40px;
            position: relative;
        }

        .progress-bar-container {
            width: 100%;
            height: 8px;
            background: #e2e8f0;
            position: absolute;
            top: 0;
            left: 0;
        }

        #progress-fill {
            height: 100%;
            background: var(--primary);
            width: 0%;
            transition: width 0.3s ease;
        }

        header {
            text-align: center;
            margin-bottom: 25px;
        }

        h1 {
            font-family: 'Arvo', serif;
            font-size: 1.6rem;
            margin: 0;
            color: var(--bg-color);
        }

        .question-number {
            font-weight: 600;
            color: var(--accent);
            text-transform: uppercase;
            font-size: 0.85rem;
            letter-spacing: 1px;
            margin-bottom: 8px;
            display: block;
        }

        .question-text {
            font-size: 1.2rem;
            line-height: 1.5;
            margin-bottom: 20px;
            font-weight: 600;
        }

        .options-list {
            list-style: none;
            padding: 0;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .option-item {
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            padding: 12px 18px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            font-size: 0.95rem;
        }

        .option-item:hover:not(.disabled) {
            border-color: var(--accent);
            background-color: #eff6ff;
        }

        .option-item.selected {
            border-color: var(--primary);
            background-color: #fefce8;
        }

        .option-item.correct-ans {
            border-color: var(--success);
            background-color: #f0fdf4;
            color: var(--success);
            font-weight: 600;
        }

        .option-item.wrong-ans {
            border-color: var(--error);
            background-color: #fef2f2;
            color: var(--error);
        }

        .option-item.disabled {
            cursor: default;
            opacity: 0.8;
        }

        input { margin-right: 12px; }

        .feedback-area {
            margin-top: 20px;
            padding: 15px;
            border-radius: 10px;
            background: var(--feedback-bg);
            border-left: 4px solid var(--accent);
            display: none;
        }

        .feedback-title {
            font-weight: 700;
            display: block;
            margin-bottom: 5px;
        }

        .justification {
            font-size: 0.9rem;
            line-height: 1.4;
            color: var(--text-light);
        }

        .nav-buttons {
            margin-top: 25px;
            display: flex;
            justify-content: space-between;
            gap: 10px;
        }

        button {
            padding: 10px 20px;
            border-radius: 8px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            font-size: 0.9rem;
            transition: opacity 0.2s;
        }

        .btn-validate { background: var(--primary); color: #000; flex-grow: 1; }
        .btn-next { background: var(--bg-color); color: white; }
        .btn-prev { background: #e2e8f0; color: var(--text-light); }
        button:disabled { opacity: 0.3; cursor: not-allowed; }

        #result-screen { text-align: center; display: none; }
        .score-circle {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            border: 6px solid var(--primary);
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.8rem;
            font-weight: 700;
            margin: 20px auto;
        }
    </style>
</head>
<body>

<div class="quiz-container">
    <div class="progress-bar-container"><div id="progress-fill"></div></div>
    
    <div id="quiz-screen">
        <header>
            <span class="question-number" id="q-count"></span>
            <h1>Tema 3: Árboles de Decisión</h1>
        </header>

        <div id="q-text" class="question-text"></div>
        <div class="options-list" id="options-container"></div>

        <div class="feedback-area" id="feedback-area">
            <span class="feedback-title" id="feedback-status"></span>
            <p class="justification" id="justification-text"></p>
        </div>

        <div class="nav-buttons">
            <button class="btn-prev" id="btn-prev" onclick="changeQuestion(-1)">Anterior</button>
            <button class="btn-validate" id="btn-validate" onclick="validateCurrent()">Validar Respuesta</button>
            <button class="btn-next" id="btn-next" onclick="changeQuestion(1)" disabled>Siguiente</button>
        </div>
    </div>

    <div id="result-screen">
        <h1>¡Test Completado!</h1>
        <div class="score-circle" id="final-score"></div>
        <p>Has finalizado el repaso sobre Árboles de Decisión.</p>
        <div style="text-align: left; background: #f1f5f9; padding: 20px; border-radius: 12px; margin-top: 20px;">
            <h3>Sugerencias de Repaso:</h3>
            <ul id="suggested-topics"></ul>
        </div>
        
        <button class="btn-next" style="margin-top: 20px; width: 100%;" onclick="location.reload()">Reiniciar Test</button>
        <button class="btn-prev" style="margin-top: 10px; width: 100%; border: 2px solid #e2e8f0;" onclick="window.location.href='index.html'">Ir al Menú Principal</button>
    </div>
</div>

<script>
    const quizData = [
        {
            question: "1. Completa esta sentencia con la opción correcta: «La clasificación mediante árboles de decisión es una tarea de aprendizaje de tipo [...]»:",
            options: ["A. Supervisado.", "B. No-supervisado.", "C. Supervisado y no supervisado.", "D. Ninguna de las anteriores."],
            correct: 0,
            type: "single",
            topic: "3.2. Introducción a Árboles de Decisión",
            justification: "El aprendizaje de árboles de decisión es una de las técnicas más utilizadas para el aprendizaje inductivo, específicamente como técnica de aprendizaje supervisado."
        },
        {
            question: "2. Indica cuáles de las siguientes afirmaciones son verdaderas:",
            options: [
                "A. El algoritmo ID3 permite valores numéricos en los atributos.",
                "B. El algoritmo C4.5 permite valores numéricos en los atributos de salida.",
                "C. Los algoritmos ID3 y C4.5 permiten valores nominales en los atributos de salida.",
                "D. El algoritmo C4.5 permite valores numéricos y nominales en los atributos de entrada."
            ],
            correct: [2, 3],
            type: "multiple",
            topic: "3.4 y 3.9. Algoritmos ID3 y C4.5",
            justification: "Los atributos de salida deben ser categorías (nominales). ID3 solo trabaja con valores discretos, mientras que C4.5 permite tanto discretos como continuos (numéricos) en la entrada."
        },
        {
            question: "3. Marca de las siguientes opciones aquellas en las que resulta adecuado utilizar un árbol de decisión en la tarea de aprendizaje:",
            options: [
                "A. No se conoce la clase de las instancias disponibles.",
                "B. La función objetivo tiene valores de salida discretos.",
                "C. Existen varios atributos de salida.",
                "D. Los datos de entrenamiento contienen errores."
            ],
            correct: [1, 3],
            type: "multiple",
            topic: "3.2. Criterios de adecuación",
            justification: "Los árboles son adecuados cuando la salida es discreta y son robustos frente a errores en los datos. No se permiten múltiples atributos de salida ni se aplican si la clase es desconocida (eso sería no supervisado)."
        },
        {
            question: "4. Indica cuál de las siguientes afirmaciones es correcta:",
            options: [
                "A. El método de selección de los atributos especifica una heurística para seleccionar el atributo que mejor discrimina los ejemplos para una clase.",
                "B. Un algoritmo básico recibe como entrada datos de entrenamiento y atributos, y obtiene como salida un método de selección.",
                "C. El método codicioso es un método de selección de atributos.",
                "D. C4.5 no utiliza un método de selección de atributos."
            ],
            correct: 0,
            type: "single",
            topic: "3.3. Tarea de inducción",
            justification: "El método de selección de atributos es un elemento crucial que determina el criterio (heurística) para generar las ramas que mejor particionan los ejemplos."
        },
        {
            question: "5. Cuando se tienen atributos con un gran número de posibles valores ¿qué método de selección de atributos conviene utilizar?",
            options: ["A. Ganancia de información.", "B. Proporción de ganancia.", "C. Indice Gini.", "D. Longitud de descripción mínima."],
            correct: 1,
            type: "single",
            topic: "3.6. Métodos de selección",
            justification: "La proporción de ganancia (usada en C4.5) compensa y penaliza los atributos que tienen muchos valores, los cuales suelen ser favorecidos erróneamente por la ganancia de información simple."
        },
        {
            question: "6. Indica cuáles de las siguientes afirmaciones son correctas respecto a ID3:",
            options: [
                "A. ID3 se basa en el método codicioso o greedy.",
                "B. ID3 considera que el atributo que aporta mayor información es el más útil.",
                "C. ID3 utiliza la medida de proporción de ganancia.",
                "D. ID3 trabaja con un espacio de hipótesis incompleto."
            ],
            correct: [0, 1],
            type: "multiple",
            topic: "3.4 y 3.5. Algoritmo ID3",
            justification: "ID3 es un algoritmo 'greedy' (no retrocede) que usa la ganancia de información como heurística fundamental. Trabaja en un espacio de hipótesis completo."
        },
        {
            question: "7. Indica las respuestas correctas en relación con los métodos de aprendizaje integrado:",
            options: [
                "A. En stacking se utilizan diferentes algoritmos en paralelo con los mismos datos y un decisor final.",
                "B. En bagging se utilizan algoritmos iguales en paralelo con subconjuntos aleatorios de datos.",
                "C. Random forest es un tipo de boosting en serie.",
                "D. En boosting se entrenan algoritmos uno a uno secuencialmente usando conjuntos aleatorios del dataset."
            ],
            correct: [0, 1],
            type: "multiple",
            topic: "3.10. Ensemble Learning",
            justification: "Stacking y Bagging funcionan en paralelo. Random Forest es una variante de Bagging, no de Boosting. Boosting funciona en serie, pero da prioridad a los casos fallidos, no usa muestras puramente aleatorias."
        },
        {
            question: "8. Indica cuáles de las siguientes afirmaciones son correctas respecto a C4.5:",
            options: [
                "A. C4.5 utiliza la medida de proporción de ganancia.",
                "B. C4.5 utiliza un método de prepoda.",
                "C. C4.5 poda el árbol utilizando datos de prueba.",
                "D. C4.5 realiza una poda una vez se ha generado el árbol."
            ],
            correct: [0, 3],
            type: "multiple",
            topic: "3.9. Algoritmo C4.5",
            justification: "C4.5 usa proporción de ganancia y realiza una poda tras la generación del árbol (pospoda) utilizando los mismos datos de entrenamiento para su estimación pesimista."
        },
        {
            question: "9. Indica cuáles de las siguientes afirmaciones son correctas respecto al método de validación cruzada:",
            options: [
                "A. Utiliza un conjunto de datos de validación y uno de entrenamiento.",
                "B. Divide los datos disponibles en dos subconjuntos.",
                "C. No se puede utilizar para evaluar la efectividad de una poda.",
                "D. Cuando se tienen pocos datos no conviene utilizarla."
            ],
            correct: [0, 1],
            type: "multiple",
            topic: "3.7. Sobreajuste y validación",
            justification: "La validación cruzada divide los datos en entrenamiento y validación. Sí es muy útil para evaluar la efectividad de la poda y es especialmente recomendable (K-fold) cuando los datos son escasos."
        },
        {
            question: "10. Indica cuáles de las siguientes afirmaciones son correctas respecto a las medidas de precisión:",
            options: [
                "A. La tasa de error es el cociente entre instancias mal clasificadas y el total.",
                "B. Cuanto mayor sea el número de instancias, el intervalo de confianza será mayor.",
                "C. C4.5 utiliza los propios datos de entrenamiento para calcular la tasa de error.",
                "D. Cuanto mayor nivel de confianza se requiere se obtiene un intervalo menor."
            ],
            correct: [0, 1],
            type: "multiple",
            topic: "3.8 y 3.9. Precisión y Error",
            justification: "La tasa de error se define por la proporción de fallos. C4.5 efectivamente usa los datos de entrenamiento para estimar el error (ajustándolo pesimistamente). Un mayor número de instancias estrecha el intervalo (lo hace menor)."
        }
    ];

    let currentIdx = 0;
    const userAnswers = new Array(quizData.length).fill(null).map(() => []);
    const validatedArr = new Array(quizData.length).fill(false);

    function render() {
        const q = quizData[currentIdx];
        const isValidated = validatedArr[currentIdx];
        
        document.getElementById('q-count').innerText = `Pregunta ${currentIdx + 1} de ${quizData.length}`;
        document.getElementById('q-text').innerText = q.question;
        document.getElementById('progress-fill').style.width = `${((currentIdx + 1) / quizData.length) * 100}%`;
        
        const container = document.getElementById('options-container');
        container.innerHTML = "";

        q.options.forEach((opt, i) => {
            const div = document.createElement('div');
            const isSelected = userAnswers[currentIdx].includes(i);
            
            let statusClass = "";
            if (isValidated) {
                const isCorrect = Array.isArray(q.correct) ? q.correct.includes(i) : q.correct === i;
                if (isCorrect) statusClass = "correct-ans";
                else if (isSelected) statusClass = "wrong-ans";
                div.classList.add("disabled");
            } else if (isSelected) {
                statusClass = "selected";
            }

            div.className = `option-item ${statusClass}`;
            const inputType = q.type === 'multiple' ? 'checkbox' : 'radio';
            div.innerHTML = `<input type="${inputType}" ${isSelected ? 'checked' : ''} ${isValidated ? 'disabled' : ''}> <span>${opt}</span>`;
            if (!isValidated) div.onclick = () => selectOption(i);
            container.appendChild(div);
        });

        document.getElementById('feedback-area').style.display = isValidated ? "block" : "none";
        if (isValidated) {
            const isCorrect = checkCorrectness(currentIdx);
            document.getElementById('feedback-status').innerText = isCorrect ? "✓ ¡Correcto!" : "✗ Incorrecto";
            document.getElementById('feedback-status').style.color = isCorrect ? "var(--success)" : "var(--error)";
            document.getElementById('justification-text').innerText = q.justification;
        }

        document.getElementById('btn-prev').disabled = currentIdx === 0;
        document.getElementById('btn-validate').style.display = isValidated ? "none" : "block";
        document.getElementById('btn-next').disabled = !isValidated;
        document.getElementById('btn-next').innerText = currentIdx === quizData.length - 1 ? "Finalizar" : "Siguiente";
    }

    function selectOption(idx) {
        if (quizData[currentIdx].type === "single") {
            userAnswers[currentIdx] = [idx];
        } else {
            const pos = userAnswers[currentIdx].indexOf(idx);
            if (pos > -1) userAnswers[currentIdx].splice(pos, 1);
            else userAnswers[currentIdx].push(idx);
        }
        render();
    }

    function validateCurrent() {
        if (userAnswers[currentIdx].length === 0) return alert("Selecciona al menos una respuesta.");
        validatedArr[currentIdx] = true;
        render();
    }

    function checkCorrectness(idx) {
        const q = quizData[idx];
        const user = userAnswers[idx].sort().join(',');
        const correct = Array.isArray(q.correct) ? q.correct.sort().join(',') : q.correct.toString();
        return user === correct;
    }

    function changeQuestion(step) {
        if (step === 1 && currentIdx === quizData.length - 1) return showResults();
        currentIdx += step;
        render();
    }

    function showResults() {
        document.getElementById('quiz-screen').style.display = 'none';
        document.getElementById('result-screen').style.display = 'block';
        let score = 0;
        const failedTopics = new Set();
        quizData.forEach((q, i) => {
            if (checkCorrectness(i)) score++;
            else failedTopics.add(q.topic);
        });
        document.getElementById('final-score').innerText = `${score}/10`;
        const list = document.getElementById('suggested-topics');
        list.innerHTML = "";
        failedTopics.forEach(t => { const li = document.createElement('li'); li.innerText = t; list.appendChild(li); });
        if (failedTopics.size === 0) list.innerHTML = "<li>¡Excelente! Dominas perfectamente los Árboles de Decisión.</li>";
    }

    render();
</script>
</body>
</html>